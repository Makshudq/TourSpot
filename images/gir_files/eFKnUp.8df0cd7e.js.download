(this.$WP=this.$WP||[]).push(["eFKnUp",(e,t)=>{"use strict";var r,o,i,n,a,l,s,u,p,c,d=e=>e.photo&&e.photo.photoSizes[e.photo.photoSizes.length-1]?e.photo.photoSizes[e.photo.photoSizes.length-1]:null,v=e=>[e.owner||e.userProfile,...(e.collaborators||[]).map((e=>e.user))].filter(Boolean),f=(e,t)=>v(e).some((e=>e.isMe||e.userId&&e.userId===t||e.id&&e.id===t)),m=e=>{var t;return null!=(t=e.owner)&&t.isMe?"OWNER":e&&f(e)?"COLLABORATOR":"PUBLIC"},h=(e,t,r,o)=>{var i=v(e);if(i=i.slice(0,t),r>0){var n=0;i=i.filter((e=>(n=e.displayName.length+n)<r))}return o&&(i=i.reverse()),i},y=(e,t)=>[...t||[]].sort(((e,t)=>e.created>t.created?1:-1)),P=e=>{var t;return null==e||null==(t=e.owner)?void 0:t.isMe},I=e=>e.owner&&e.owner.isMe?"OWNER":f(e)?"COLLABORATOR":"VIEWER",T=(e,t)=>(e.items||[]).find((e=>{var r,o,i,n,a,l=e.reference&&e.reference.type&&e.reference.type.toLowerCase(),s=null==(r=e.reference)?void 0:r.id,u=t.type.toLowerCase(),p=t.id.toString(),c="originalObject"in t&&(null==(o=t.originalObject)||null==(i=o.type)?void 0:i.toLowerCase()),d="originalObject"in t&&(null==(n=t.originalObject)||null==(a=n.id)?void 0:a.toString());return l===u&&s===p||l===c&&s===d})),w=(e,t)=>{var r=T(e,t);return r?r.id:null},_={locationinformation:"location",attractionproductinformation:"attractionProduct",forumpost:"post",tripitem:"savesItem",linkpost:"link",linkpost_linkpostv2:"link",photo:"photo",video:"video",review:"review",repost:"repost",trip:"bundleSave",tripnotes_tripnote:"note"},O={locationinformation:"LOCATION",attractionproductinformation:"ATTRACTIONPRODUCT",forumpost:"POST",tripitem:"SAVESITEM",linkpost:"LINK",photo:"PHOTO",video:"VIDEO",review:"REVIEW",repost:"REPOST",trip:"TRIPCONTENT"},L=e=>({statQuery:e}),R=e=>_[e.toLowerCase()],S=e=>O[e.toLowerCase()],g=["LocationInformation","AttractionProductInformation","ForumPost","LinkPost","LinkPost_LinkPostV2","Review","Photo","Video","Repost","Trip","TripNotes_TripNote"],b=e=>{switch(e.__typename){case"AttractionProductInformation":case"LocationInformation":return[e];case"Photo":case"Review":return[e.location];case"Video":return e.orderedLocations;case"ForumPost":case"LinkPost":case"TripNote":default:return[]}},k=(e,t)=>{if(!e)return null;var r=(e=>{var t,r,o,i,n,a;return null!=(t=null!=(r=null!=(o=null!=(i=null!=(n=null!=(a=e.locationId)?a:e.attractionProductId)?n:e.postId)?i:e.repostId)?o:e.linkPostId)?r:e.id)?t:void 0})(e),o=e.__typename?R(e.__typename):null;if(null!=r&&null!=o){if(g.includes(e.__typename))return{type:o,id:r};var i={id:e.reference.id,type:"attractionproduct"===e.reference.type?"attractionProduct":e.reference.type};if("TripItem"===e.__typename&&e.reference&&e.reference.id&&e.reference.type)return t&&"note"!==i.type?i:{type:o,id:r,originalObject:i}}return null},j=e=>({id:`${e.id}`,type:e.type}),C=(e,t)=>`/Trips/${e}${t?`?itemId=${t}`:""}`,A=e=>{var t=c[e.type];return t?{...e,query:t.statQuery,variables:{ids:[e.id]}}:null},E=e=>{var t,r;return["LinkPost","Photo","Review","Video"].includes(null==e||null==(t=e.object)||null==(r=t.repostedObject)?void 0:r.__typename)},F=(e,t)=>{if("_blank"===t){var r=window.open("about:blank",t);return()=>{null!=r&&(r.location=e)}}return()=>{window.open(e,t)}};function N(e,t){return e.reduce(((e,r)=>(t(r)?e[0].push(r):e[1].push(r),e)),[[],[]])}var V=e=>{if(!("__typename"in e))return[];if("LinkPost_LinkPostV2"===e.__typename){var t,r,o=null!=(t=null==(r=e.preview)?void 0:r.media)?t:[];if(!o.length)return[];var i,n,a,l=o.reduce(((e,t)=>t&&t.object?[...e,t]:e),[]).sort(((e,t)=>t.id-e.id)),[s,u]=N(l,(e=>"LinkPreview_PhotoRefV2"===e.__typename));if(s.length)return null!=(i=null==(n=s[0])||null==(a=n.object)?void 0:a.photoSizes)?i:[];if(u.length)return[u[0].object]}if("LinkPost"===e.__typename){var p=e.preview&&e.preview.media||[];if(0===p.length)return[];var c,d,v=e=>{var t;return null!=(t="Photo"===e.__typename?e.photoId:e.previewId)?t:0},f=p.filter(Boolean).sort(((e,t)=>v(t)-v(e))),[m,h]=N(f,(e=>"Photo"===(null==e?void 0:e.__typename)));if(m.length)return null!=(c=null==(d=m[0])?void 0:d.photoSizes)?c:[];if(h.length)return[h[0]]}return[]};return[()=>{c=Object.freeze({location:L(p),attractionProduct:L(r),post:L(o),savesItem:L(i),link:L(n),review:L(a),photo:L(l),video:L(s),repost:L(u)}),e({buildPublicTripShareUrl:C,getCommentsForDisplay:y,getItemByReference:T,getItemIdByReference:w,getPhotoSizesForLinkPost:V,getQueryReferenceTypeFromObjectType:S,getReferenceTypeFromObjectType:R,getTripCoverPhoto:d,getTripUsers:v,getTripUsersForDisplay:h,isOwner:P,isRepostSaveable:E,isTripUser:f,locationsForItem:b,objectStatisticQuery:A,toReference:j,toSavesObject:k,userRelation:I,userTypeFromTrip:m,windowOpener:F})},[e=>(r=e.AttractionStatistics,o=e.ForumStatistics,i=e.TripItemStatistics,n=e.LinkPostStatistics,a=e.ReviewStatistics,l=e.PhotoStatistics,s=e.VideoStatistics,u=e.RepostStatistics,p=e.LocationStatistics)]]},["RXx5aI"]]);
