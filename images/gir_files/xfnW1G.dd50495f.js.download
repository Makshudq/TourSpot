(this.$WP=this.$WP||[]).push(["xfnW1G",(e,r)=>{"use strict";var t,o,a,n,i,s,l,c,d,p,u,g,v,h,C,_,f,y,P,k,T,m,I,A,E,x,N,w,S,O,b,G,K=()=>{var{page:e}=o(),r=t({experimentKeys:["add_shopping_cart_icon_across_ta_1652149198"]},!("AttractionToursAndTickets"===e||"AttractionsHome"===e||"AttractionsNear"===e||"ShoppingCart"===e||"AttractionsFusion"===e||"Attraction_Review"===e||"AttractionProductsFusion"===e||"AttractionProductReview"===e));return null!=r&&"test"===r.add_shopping_cart_icon_across_ta_1652149198},R=({onClose:e})=>{var{localize:r}=n();return s(a,{className:"wxIqd",children:s(i,{hidden:!0,isModalOnly:!0,onClose:e,highlightFirstResult:!0,closeOnResultClicked:!0,styleVariant:"box",searchMode:"GeoPicker",overlayVariant:"topCentered",scope:{geoId:1,linkType:"ATTRACTIONS"},source:"ExpCartIconPopover_ExploreNow_Geopicker",placeholderText:r.string("mobile_discovery_where_to")})})},M=(e,r)=>({click:{trackingKey:JSON.stringify({flow:"GlobalNavCartIcon",pageType:r}),trackingTitle:"AutoOpenedCartIconPopover",clientParameter:"ShoppingCart",sessionId:e}}),D=(e,r)=>({click:{trackingKey:JSON.stringify({flow:"GlobalNavCartIcon",pageType:r}),trackingTitle:"UserClosedCartIconPopover",clientParameter:"ShoppingCart",sessionId:e}}),F=(e,r)=>({click:{trackingKey:JSON.stringify({flow:"GlobalNavCartIcon",pageType:r}),trackingTitle:"ExploreNowClickCartIconPopover",clientParameter:"ShoppingCart",sessionId:e}}),V={__key:0x9dad92733350,id:"9dad92733350792d6fda9af4d08cde62",loc:{},definitions:[]},L=(e,r,t)=>{var o,a,[{data:n,fetching:i}]=v({query:V,variables:{page:e||"",geoId:t},pause:r});return{url:(null==n||null==(o=n.routes)||null==(a=o[0])?void 0:a.url)||null,fetching:i}},U=({overrideTypography:e=!1,hidePopover:r=(()=>{}),setGeoPickerOpened:t})=>{var{localize:a}=n(),i=g(),{page:l,params:c}=o(),v=u(),h="geoId"in c&&c.geoId||null,C=null==h||h<=1,{url:_}=S("Attractions",C,h),f=e=>{i({AppPresentation:F(v,l)}),r(),e.stopPropagation(),C&&(t(!0),e.preventDefault())},y=_||"/Attractions",P=a("TTD_Explore_Now");return e?s(p,{theme:"inline",role:C?"button":void 0,href:y,onClick:f,children:P}):s(d,{role:C?"button":void 0,href:y,onClick:f,children:P})},W=({isCartEmpty:e,hidePopover:r,setGeoPickerOpened:t})=>{var{localize:o}=n(),a=s(x,{variant:"title-04",marginBottom:"spacing-02",children:o(e?"TTD_Add_Things_To_Cart":"TTD_Book_More_Things")}),i=s(x,{variant:"body-01",children:o(e?"TTD_Empty_Cart_Popover_Message":"TTD_Product_Cart_Popover_Message")});return l("div",{className:E({margin:"spacing-04"}),"data-automation":"cartPopover",children:[a,i,s(O,{hidePopover:r,setGeoPickerOpened:t})]})},q="expCartPopoverInfo",B=({triggerRef:e,isCartEmpty:r})=>{var{page:t}=o(),a="MOBILE"===T(),n=g(),i=u(),d=m(),p=h(null),[v,E]=C(!1),[x,S]=C(!1);_((()=>{"ShoppingCart"!==t&&!a&&(e=>{var r=N.get(q);return!r||r.lastUserId!==e})(d)&&(n({AppPresentation:M(i,t)}),(e=>{var r={lastUserId:e};N.set(q,r,G)})(d),S(!0))}),[i,d,t,S,n,a]);var O=h(!1),K=f((()=>{e.current&&e.current.focus(),O.current=!1,S(!1)}),[e,O,S]),R=P((e=>{var r;x&&e.target instanceof Node&&null!=(r=p.current)&&r.contains(e.target)?O.current=!0:x&&("click"===e.type||"touchstart"===e.type||e instanceof KeyboardEvent&&e.keyCode===y)&&(n({AppPresentation:D(i,t)}),K())}),150,{leading:!0,trailing:!0});return k("mousemove",R,void 0),k("keyup",R,void 0),k("click",R,void 0),k("touchstart",R,{passive:!1}),e.current?l(c,{children:[x&&s(A,{children:s(I,{unstyled:!0,autoFocus:!0,position:"below",alignEdge:"right",arrowType:"small",shouldRestoreFocus:!0,showArrowWhenUnstyled:!0,target:e.current,children:s("div",{ref:p,className:"gUpLp f H e _V Ra Gi",onMouseLeave:()=>{n({AppPresentation:D(i,t)}),K()},children:s(b,{isCartEmpty:r,hidePopover:K,setGeoPickerOpened:E})})})}),v&&s(w,{onClose:()=>E(!1)})]}):(console.error("[ShoppingCart] no trigger ref for cart icon popover"),null)};return[()=>{S=L,b=W,G=432e6,e({CartIconPopover:B,ExploreNowCta:O=U,GeoPickerModal:w=R,useCartIconPopoverEnabled:K})},[e=>t=e.default,e=>o=e.useRoute,e=>a=e.OverlayPortal,e=>n=e.useLocalize,e=>i=e.default,e=>(s=e.jsx,l=e.jsxs,c=e.Fragment),e=>d=e.BorderlessButton,e=>p=e.default,e=>u=e.useSessionId,e=>g=e.useInteractionLogger,e=>v=e.useQuery,e=>(h=e.useRef,C=e.useState,_=e.useEffect,f=e.useCallback),e=>y=e.KEY_ESCAPE,e=>P=e.default,e=>k=e.useWindow,e=>T=e.useViewportCategory,e=>m=e.useUserId,e=>I=e.default,e=>A=e.AfterConsent,e=>E=e.margin,e=>x=e.default,e=>N=e.default]]},["S-RL4Q","F8raOV","vq6MSq","0DsHEV","Kv5xL1","F5FCuN","7yGKf-","5KqyYa","VJ7DQx","fsml46","5X2em-","cDcdfi","h7E4Ym","gsKhh7","Dg5_-9","oVKaZR","ukkKxE","MHKLZN","lMO0v3","iekllc","VP50Wc","jaCyxS"]]);
