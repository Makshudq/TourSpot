(this.$WP=this.$WP||[]).push(["usZKla",(e,t)=>{"use strict";var o,u,r,a,n,c,s,l,d,i,p,C,h,m,I,P,T,v,k,A,y,g,O,R,S,D,b=({checkoutItem:e,onClose:t})=>{var o=e.productParameters,{productId:u,productCode:r,tourGradeCode:n,checkinDate:c,checkinDateUI:s,cancellationCondition:l,bookingProduct:d}=o,i=e.display,{passengerMix:p}=i,C=e.availability.priceFormatted;return"PAST_CHECKIN_DATE"!==e.notificationType&&(e=>{var[t,o,u]=e.split("-").map((e=>parseInt(e,10)));return new Date(t,o-1,u)})(c)>=new Date?k(a,{productId:u,productCode:r,tourGradeCode:n,pax:p,travelDate:c,travelDateUI:s,displayedPrice:C,cancellationMessage:l,productDisplay:i,isAvailable:!e.notificationType,bubbleRating:null==d?void 0:d.rating,numReviews:null==d?void 0:d.num_reviews,itemId:e.id,onClose:t}):null},f=e=>{var t=g.get(i),o=g.get(n);return t||o?t&&o?t.timestamp>o.timestamp?"CART":"CHECKOUT":t?"CHECKOUT":"CART":e?"CHECKOUT":"CART"},_=({checkout:e,cart:t})=>{var{status:o,data:u}=(({runQuery:e})=>O({runQuery:e,checkout:!0}))({runQuery:e}),{status:r,data:a}=(({runQuery:e})=>O({runQuery:e,checkout:!1}))({runQuery:t});return"Fetching"===o||"Fetching"===r?{checkoutItem:null,cartItems:null}:{checkoutItem:null!=u&&u.length>0?u[0]:null,cartItems:null!=a&&a.length>0?a:null}},E=({checkoutItem:e,onClose:t})=>{var[o]=v();return"control"===o?k(R,{checkoutItem:e,onClose:t}):k(d,{productItems:[e],abandonedModalType:"CHECKOUT",onClose:t})},F=({hidePopup:e})=>{var t=A(),o=u((()=>p(t)),[t]),a=u((()=>c(t)),[t]),[n]=v(),i="Treatment 1"===n,y="Treatment 2"===n;r((()=>{C(),h(),(i||y)&&(m(n),I(n))}),[n,i,y]);var{checkoutItem:g,cartItems:O}=D({cart:o,checkout:a});if(!g&&!O)return null;var R=!!g&&s(l(g)),b=!!O&&P(T(O));return b&&R&&O&&g?"CART"===S(i||y)?k(d,{productItems:O,abandonedModalType:"CART",onClose:e}):k(E,{checkoutItem:g,onClose:e}):R&&g?k(E,{checkoutItem:g,onClose:e}):b&&O?k(d,{productItems:O,abandonedModalType:"CART",onClose:e}):(e(),null)},w=()=>{var{page:e}=y(),t="AttractionsNear"===e||"AttractionsFusion"===e||"Attraction_Review"===e||"AttractionProductsFusion"===e||"AttractionProductReview"===e,[u,r]=o(!0);return t&&u?k(F,{hidePopup:()=>r(!1)}):null};return[()=>{R=b,S=f,D=_,e("default",w)},[e=>(o=e.useState,u=e.useMemo,r=e.useEffect),e=>(a=e.CheckoutItemProductInformation,n=e.CHECKOUT_POPUP_INFO_SNAPSHOT_KEY,c=e.shouldShowPopup,s=e.shouldShowPopupWithRetrievedPopupInfo,l=e.buildCheckoutProductInfo),e=>(d=e.default,i=e.CART_POPUP_INFO_SNAPSHOT_KEY,p=e.isCartPopupExpired,C=e.clearOutdatedStoredCartValues,h=e.clearOutdatedStoredCheckoutValues,m=e.tryResetCartSuppressValue,I=e.tryResetCheckoutDismissValue,P=e.shouldShowCartPopup,T=e.buildCartProductInfo),e=>v=e.useNewCheckoutDesignAndAbandonedPopupLogicTest,e=>k=e.jsx,e=>A=e.useSessionId,e=>y=e.useRoute,e=>g=e.default,e=>O=e.useFetchShoppingData]]},["cDcdfi","bre2zH","MNe656","DY6uxn","F5FCuN","VJ7DQx","F8raOV","jaCyxS","W15VPO"]]);
