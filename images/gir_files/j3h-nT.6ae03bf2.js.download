(this.$WP=this.$WP||[]).push(["j3h-nT",(e,t)=>{"use strict";var n,i,l,a,o,r,d,s,c,u,p,v,m,g,h,f,w,b,_,k,I,C,y,T,x,R,M,N,S,P,D,L,A,B,V,j,O,E,z,W,q,F,K,U,X,H,J,Q,Y,G,$,Z,ee,te,ne,ie,le,ae,oe,re,de,se,ce,ue,pe,ve,me,ge,he,fe,we,be,_e,ke,Ie,Ce,ye,Te={__key:0xe99ca02f4b3a,id:"e99ca02f4b3aac3736b05f5b8fab0fc7",loc:{},definitions:[]},xe=e=>{var t=({variables:t})=>String(t.objectId)===String(e.objectId)&&t.objectType===e.objectType?"invalidateAndRefetch":"validate",[{data:n,fetching:i,error:l}]=A({query:Te,variables:{socialObjects:[e]},executeWhen:"afterInvalidation"},{addLikeV2:t,deleteLikeV2:t});return!i&&!l&&n&&n.socialStatistics&&n.socialStatistics.length&&n.socialStatistics[0]||null},Re={__key:0x5c3f35360736,id:"5c3f35360736675070515627892f4efc",loc:{},definitions:[]},Me={__key:0xd80ef1944285,id:"d80ef1944285523c3c5d6f7bb7a248d7",loc:{},definitions:[]},Ne=({item:e,socialObject:t,onClick:r})=>{var d,s,[,c]=C(Re),[,u]=C(Me),p=M(),v=S(),[m]=n(x),g=D(),h=P(),[f,b]=i(null),k=l((()=>t||{objectType:L[e.__typename],objectId:String(e.id)}),[t,e]),I=(null==(d=e.socialStatistics)?void 0:d.isLiked)||!1,y=(null==(s=e.socialStatistics)?void 0:s.likeCount)||0,N=ue(k);a((()=>{b(null)}),[N]);var A=T(I,(N||{}).isLiked),B=T(y,(N||{}).likeCount),V=o((()=>!0===A?u(k):c(k)),[A=null===f?A:f,k,u,c]),j=o((()=>e=>{var t;"NO_PERMISSION"===(null==(t=e.addLike)?void 0:t.statusType)&&m({node:_(R,{children:_(w,{id:"social_no_permission"})}),timeout:8e3})}),[m]);return[o((()=>{h({flowOrigin:"login",pid:40469}).then((()=>{r&&r();var e={actorUserId:v,uid:p};g({UgcDetail:!0===A?{unhelpful:e}:{helpful:e}}),b(!A)})).then(V).then(j)}),[A,b,V,j,h,g,r,v,p]),!0===A,B||0]},Se=({id:e,type:t,helpfulVoteCount:n,isLiked:i=!1,onLikeClick:l})=>{var{localize:a}=b(),o={__typename:t,socialStatistics:{isLiked:i,likeCount:n},id:e},[r,d,c]=pe({item:o,onClick:l});return _(s,{variant:"clear",icon:d?h:f,onClick:r,size:"small","aria-label":d?a.string("sng_click_to_remove_helpful_vote"):a.string("sng_click_to_add_helpful_vote"),children:c})},Pe=({model:e})=>{var{hasVotedReviewHelpful:t,helpfulVoteAction:n,helpfulVotes:i}=e,{trackClick:l}=V();if(null==(null==n?void 0:n.objectId))return console.error("[Fusion] The helpful vote id was not present so the module could not be created"),null;var a=parseInt(n.objectId,10),o=parseInt(null==i?void 0:i.text,10)||0;return _(ve,{id:a,type:"Review",helpfulVoteCount:o,isLiked:t||!1,onLikeClick:()=>l({clientContext:"voteReview"})})},De={__key:0x5bb83a24d45d,id:"5bb83a24d45d62096490819df02c9ad6",loc:{},definitions:[]},Le=({reviewId:e,onClick:t})=>{var[,i]=C(De),[l]=n(x),a=P(),r=o((()=>e=>{e.removeReview||l({node:_(R,{children:_(w,{id:"social_no_permission"})}),timeout:8e3})}),[l]),d=o((()=>i({id:e})),[i,e]);return[o((()=>{a({flowOrigin:"login",pid:40469}).then((()=>{try{t&&t()}catch(e){console.error("problem occurred when triggering onClick in delete review flow")}})).then(d).then(r)}),[a,d,r,t])]},Ae=({reviewId:e,onClose:t,onDeleteReview:n})=>{var{localize:i}=b(),[l]=ge({reviewId:e}),a=o((e=>{n&&n(),e(),l()}),[n,l]);return Z((({close:e})=>_($,{title:i("delete_confirmation_header_review_0"),onClose:e,primaryButton:_(d,{onClick:()=>a(e),children:i("inbox_swipe_delete")}),secondaryButton:_(d,{variant:"secondary",onClick:e,children:i("aao_delete_cancel_btn_fffff375")}),children:_(v,{variant:"body-01",elementType:"span",marginLeft:"spacing-04",marginTop:"spacing-04",children:i("delete_confirmation_description_review_0")})})),{onClose:t})},Be=({model:e,reviewId:t,onReviewDelete:n,ownerReview:i=!1})=>{var{localize:a}=b(),{trackClick:r}=V(),{open:d}=G({id:String(t)}),{open:c}=Y({id:String(t),onClose:()=>r({clientContext:"closeReportModal"})}),{open:u}=he({reviewId:t,onDeleteReview:()=>{r({clientContext:"selectDeleteInModal"}),n&&n()}}),p=o(((e,t)=>{"ReportIAPWebviewAction"===e&&t?(r({clientContext:"reportManagementResponse"}),d()):"ReportIAPWebviewAction"===e?(r({clientContext:"reportReview"}),c()):"DeleteMediaMutationAction"===e&&(r({clientContext:"deleteReview"}),u())}),[r,d,c,u]),v=l((()=>e?e.filter(Boolean).filter((e=>{var t;return null!=(null==(t=e.actionName)?void 0:t.text)})).map((e=>{var t;return{onClick:()=>p(e.actionType,i),displayName:null==(t=e.actionName)?void 0:t.text}})):[]),[e,i,p]);return v&&_("div",{className:"_T",children:_(Q,{options:v,menuVariant:"trailing-top-caret",label:a.string("sng_review_options"),mode:"menu",onOpen:()=>r({clientContext:"threeDotCTA",clientParameter:i?"ownerResponse":"review"}),fullscreenMobile:!0,trigger:({active:e,onKeyDown:t,ariaAttributes:n,ref:i,onClick:l})=>_(s,{ref:i,ariaAttributes:n,onKeyDown:t,variant:"clear",icon:J,size:"small","aria-label":e?a.string("sng_close_options_menu"):a.string("sng_open_options_menu"),onClick:e=>{l&&l(e)}})})})},Ve=({model:e})=>{var t,{displayName:n,ownerResponseId:i,profileImage:l,profileRoute:a,publishedDate:o,reportAction:r,text:d}=e,{trackClick:s}=V(),c=ee();null===i&&console.error("The owner response id was not able to be parsed, will continue to show owner response, with no review actions");var p=(null==a?void 0:a.webLinkUrl)||(null==a?void 0:a.url)||void 0,m=null==l||null==(t=l.photoSizes)?void 0:t.filter(Boolean).map((e=>({url:e.url||"",width:e.width||0,height:e.height||0})));return k(I,{children:[k("div",{className:"CXZQW M k MI",children:[null!==n&&_(H,{variant:"two-line",profileInfo:[{displayName:n,avatarSource:m,profileHref:p}]}),r&&null!==i&&_("div",{className:"Sgbpo",children:_(fe,{model:[r],reviewId:i,ownerReview:!0})})]}),_(u,{onExpand:()=>s({clientContext:"readMore"}),children:_(v,{variant:"body-01",children:d})}),o&&_(v,{variant:"supporting-02",marginBottom:"spacing-02",marginTop:"spacing-03",children:_(U,{model:o})}),_(v,{variant:"supporting-02",children:c("MANAGEMENT")})]})},je=({model:e})=>{var{label:t,value:n}=e;return k("div",{className:"d Mj Nj MI NL",children:[_("span",{className:"bfHbu",children:_(te,{color:"bubbleIcon",size:16})}),n&&_(v,{variant:"title-05",elementType:"span",marginX:"spacing-01",children:_(U,{model:n})}),t&&_(v,{variant:"body-01",elementType:"span",children:_(U,{model:t})})]})},Oe={__key:0xf12f5e212206,id:"f12f5e212206ea84fdbe021db1bb1f92",loc:{},definitions:[]},Ee=(e,t,n=!1)=>{return i=y({query:Oe,variables:l((()=>({...e,request:{...e.request,updateToken:t}})),[e,t]),pause:n}),l((()=>{var[{data:e,...t},n]=i;return[{...t,data:null==e?void 0:e.Result,operation:void 0},n]}),[i]);var i},ze=({onClose:e,translationButtonInfo:t})=>{var n,i,l,a,o,r,d,s;"Routing_OnDemandReviewMachineTranslationParameters"===(null==(n=t.webRoute)||null==(i=n.typedParams)?void 0:i.__typename)&&({contentType:o,contentId:r,reviewId:d,targetLanguage:s}=t.webRoute.typedParams);var{localize:c}=b(),[{data:u,fetching:p,polling:m,error:g}]=ke({request:{routeParameters:{contentId:r,contentType:o,reviewId:d,targetLanguage:s}}}),h=null==u||null==(l=u.sections)||null==(a=l[0])?void 0:a.content,f=p||m;return _($,{onClose:e,widthOption:"fixed-40",children:k("div",{className:"MM",children:[(null!=g||null==h&&!f)&&_(v,{variant:"title-02",children:_(w,{id:"sng_translating_review_error"})}),f&&_("div",{className:"f u j",children:_(le,{variant:"large","aria-label":c.string("fusion_review_translation_loading")})}),!f&&null!=h&&_(ye,{model:h,isTranslatedReview:!0})]})})},We=({photos:e,onOpenPhoto:t,onCloseMediaViewer:n,contentType:l})=>{var a=N(),{locationId:r,pageName:d}=((e,t,n)=>{var i,l,a=null==(i=t.find(Boolean))||null==(l=i.photo)?void 0:l.locationId,o=(e=>{switch(e){case"attraction_product":return"AttractionProductReview";case"attraction":return"Attraction_Review";case"hotel":return"Hotel_Review";case"restaurant":return"Restaurant_Review";default:return null}})(n);return null!=o&&null!=a?{locationId:a,pageName:o}:null!=a&&a!==e.params.detailId&&"Attraction_Review"===e.page?{locationId:a,pageName:"AttractionProductReview"}:{locationId:e.params.detailId||0,pageName:String(e.page)}})(a,e,l),s=oe(d),c={...re,...de(d)},[u,p]=i(null),{localize:v}=b(),{actionHandler:m}=se(),g=o((()=>{p(null),n&&n()}),[n]),h=o((e=>{p({mediaId:{id:e||0,type:"p"},albumId:s}),t&&t(e)}),[s,t]);return k(I,{children:[u&&_(ce,{locationId:r,initialSettings:u,onClose:g,actionHandler:m,...c.mediaViewerParams}),_("div",{className:"LblVz _e q",children:e.filter(Boolean).map((e=>{var t,n,i;return _("button",{className:"ajoIU _S B-",onClick:()=>h(e.photoId),"aria-label":v.string("sng_see_full_review_image"),children:_(ae,{source:null!=(t=null==(n=e.photo)?void 0:n.photoSizeDynamic)?t:null==(i=e.photo)?void 0:i.photoSizes,width:100,height:100})},e.photoId)}))})]})},qe=e=>""!==e&&e,Fe=({seoProps:e,children:t})=>{var n=e&&e.lang?e.lang:void 0;return n?_("span",{lang:n,children:t}):t},Ke=(e,t)=>_(Fe,{seoProps:t,children:_(q,{model:e})}),Ue=({isTranslatedReview:e,helpfulVote:t,reviewActions:n,setReviewDeleted:i})=>{var l;return e?null:null!=t&&null!=(l=t.helpfulVoteAction)&&l.objectId?k("div",{className:"f",children:[t&&_(me,{model:t}),n&&_(fe,{model:n,reviewId:parseInt(t.helpfulVoteAction.objectId,10),onReviewDelete:()=>i(!0)})]}):(console.error("[Fusion] The review id was not able to be parsed, will continue to show review, with no review actions"),null)},Xe=({model:e,isTranslatedReview:t=!1,contentType:n})=>{var{bubbleRatingNumber:l,bubbleRatingText:a,cardLink:o,helpfulVote:d,htmlText:s,htmlTitle:h,labels:f,machineTranslationProvider:w,ownerResponse:b,photos:I,publishedDate:C,reviewActions:y,safetyText:T,seoProps:x,subratings:R,supplierName:M,tip:N,tipText:S,userProfile:P,onDemandTranslationButton:D}=e,[L,A]=i(!1),[B,{openModal:j,closeModal:O}]=ne("googleTranslate"),{trackClick:E}=V(),z=ee(),{url:H,trackingContext:J}=m({internalOrExternalLink:o}),{text:Q}=g(D),{text:Y,url:G,trackingContext:$}=g(M),Z=null!==x?JSON.parse(x):void 0,te=new Map([["Language Weaver",3],["Language Weaver/TA Edited",4],["Google",5],["MicroSoft",6],["ProMT",7],["AsiaOnline",8]]).get(w);return!L&&k("div",{className:"_c","data-automation":"reviewCard",children:[k("div",{className:"mwPje f M k",children:[P&&_(X,{model:P}),_(Ue,{isTranslatedReview:t,helpfulVote:d,reviewActions:y,setReviewDeleted:A})]}),Y&&_(v,{variant:"title-05",marginY:"spacing-02",children:qe(G)?_(W,{href:G,theme:"standalone",trackingDetails:{clientContext:$},children:_(U,{model:Y})}):_(U,{model:Y})}),f&&f.length>0&&_("div",{className:"TqVEa",children:f.filter(Boolean).map(((e,t)=>_(K,{model:e},t)))}),_("div",{children:null!==l&&_(r,{rating:l})}),h&&_(v,{variant:"title-05",marginY:"spacing-02",children:qe(H)?_(W,{href:H,theme:"standalone",trackingDetails:{clientContext:J},children:Ke(h,Z)}):Ke(h,Z)}),T&&k("div",{className:"ngcUv",children:[_(p,{size:20,color:"dangerIcon"}),_(v,{variant:"title-05",elementType:"span",marginX:"spacing-02",children:_(U,{model:T})})]}),a&&null!==a.text&&_("div",{className:"RpeCd",children:_(F,{model:a})}),s&&k(u,{variant:"extended",onExpand:()=>E({clientContext:"readMore"}),children:[_(Fe,{seoProps:Z,children:_(q,{model:s})}),R&&_("div",{children:R.filter(Boolean).map(((e,t)=>_(be,{model:e},t)))})]}),k("div",{children:[N&&_(v,{variant:"title-05",marginRight:"spacing-01",elementType:"span",children:_(U,{model:N})}),S&&_(U,{model:S})]}),I&&I.length>0&&_(Ce,{photos:I,onOpenPhoto:e=>E({clientContext:"openMediaViewer",clientParameter:String(e)}),onCloseMediaViewer:()=>E({clientContext:"closeMediaViewer"}),contentType:n}),!t&&null!=Q&&_(c,{onClick:j,marginTop:"spacing-04",marginBottom:"spacing-02",children:_(U,{model:Q})}),t&&_("div",{className:"JsqaP",children:_("a",{href:"https://translate.google.com",target:"_blank",children:_("img",{src:"/img2/google/powered_by_google_translate.png",alt:"Google"})})}),k("div",{className:"TreSq",children:[te&&_(v,{variant:"supporting-02",marginBottom:"spacing-02",children:_(ie,{providerId:te})}),C&&_(v,{variant:"supporting-02",marginBottom:"spacing-02",children:_(U,{model:C})}),_(v,{variant:"supporting-02",marginBottom:"spacing-03",children:z("MEMBER")})]}),!t&&b&&_("div",{className:"hjJJO PJ",children:_(we,{model:b})}),!t&&D&&B&&_(Ie,{onClose:O,translationButtonInfo:D})]})};return[()=>{ue=xe,pe=Ne,ve=Se,me=B(Pe),ge=Le,he=Ae,fe=j(Be),we=j(Ve),be=B(je),_e=O({executeQuery:Ee,extractPollingStatus:e=>E(null==e?void 0:e.status),mergeUpdate:z}),ke=_e,Ie=ze,Ce=We,ye=j(Xe),e("default",ye)},[e=>(n=e.useContext,i=e.useState,l=e.useMemo,a=e.useEffect,o=e.useCallback),e=>r=e.BubbleRating,e=>(d=e.default,s=e.CircularButton,c=e.BorderlessButton),e=>u=e.default,e=>p=e.default,e=>v=e.default,e=>(m=e.deriveLinkInfo,g=e.deriveLinkInfoFromInternalLink),e=>h=e.default,e=>f=e.default,e=>(w=e.default,b=e.useLocalize),e=>(_=e.jsx,k=e.jsxs,I=e.Fragment),e=>(C=e.useMutation,y=e.useQuery),e=>T=e.default,e=>(x=e.Toast,R=e.ToastItem),e=>(M=e.usePageviewUid,N=e.useRoute),e=>S=e.useUserId,e=>P=e.default,e=>D=e.useInteractionLogger,e=>L=e.SocialObjectTypeMap,e=>A=e.useInvalidatableQuery,e=>(B=e.FusionComponent,V=e.useTracking,j=e.fused,O=e.createUseWPSQuery,E=e.defaultExtractPollingStatus,z=e.defaultMergeSectionResults,W=e.FusionTrackedLink),e=>q=e.default,e=>F=e.default,e=>K=e.Label,e=>U=e.default,e=>X=e.default,e=>H=e.default,e=>J=e.default,e=>Q=e.DropdownMenu,e=>(Y=e.default,G=e.useReportManagementResponseModal),e=>$=e.Modal,e=>Z=e.useVDOMPortal,e=>ee=e.default,e=>te=e.default,e=>ne=e.useModalWithTracking,e=>ie=e.default,e=>le=e.Spinner,e=>ae=e.default,e=>(oe=e.getDefaultAlbumId,re=e.defaultMediaSettings,de=e.getPageMediaSettings),e=>se=e.default,e=>ce=e.default]]},["cDcdfi","MBK0so","7yGKf-","McEGSJ","8R-NfT","VP50Wc","q-7VD4","5NyHS9","-MsDxx","0DsHEV","F5FCuN","5X2em-","XDyWKx","Q7TAd7","F8raOV","ukkKxE","mv7yXI","fsml46","CXMmrT","OnmvvE","PEYes_","2s99p_","nrwKz6","DbdFu5","2dxA8m","9sBp28","g7DBrU","0y_gi3","MCrJhI","IxKOOk","E1X9WP","vq6MSq","4krwtg","YSwnxW","4w1BVK","511DFe","Ly5eaD","BgJkqv","Kf3KYD","XYs9im","_azji4"]]);
